# Z AI SDK ä½¿ç”¨æŒ‡å—

è¿™ä¸ªæŒ‡å—è¯´æ˜å¦‚ä½•ä½¿ç”¨ `z-ai-sdk` ä¸è‡ªå®šä¹‰ AI æ¥å£è¿›è¡Œäº¤äº’ï¼ŒåŒ…æ‹¬èŠå¤©å¯¹è¯ã€å›¾ç‰‡ç”Ÿæˆã€éŸ³é¢‘å¤„ç†ç­‰åŠŸèƒ½ã€‚

## ç›®å½•

- [Z AI SDK ä½¿ç”¨æŒ‡å—](#z-ai-sdk-ä½¿ç”¨æŒ‡å—)
  - [ç›®å½•](#ç›®å½•)
  - [1. é…ç½®](#1-é…ç½®)
  - [2. å®‰è£…](#2-å®‰è£…)
  - [3. JavaScript/TypeScript API](#3-javascripttypescript-api)
    - [3.1 èŠå¤©å®Œæˆ](#31-èŠå¤©å®Œæˆ)
    - [3.2 è§†è§‰æ¨¡å‹èŠå¤©](#32-è§†è§‰æ¨¡å‹èŠå¤©)
    - [3.3 æ–‡æœ¬è½¬è¯­éŸ³ (TTS)](#33-æ–‡æœ¬è½¬è¯­éŸ³-tts)
      - [æµå¼ä¼ è¾“æ ¼å¼](#æµå¼ä¼ è¾“æ ¼å¼)
    - [3.4 è¯­éŸ³è½¬æ–‡æœ¬ (ASR)](#34-è¯­éŸ³è½¬æ–‡æœ¬-asr)
    - [3.5 å›¾ç‰‡ç”Ÿæˆ](#35-å›¾ç‰‡ç”Ÿæˆ)
    - [3.6 è§†é¢‘ç”Ÿæˆ](#36-è§†é¢‘ç”Ÿæˆ)
    - [3.7 å¼‚æ­¥ç»“æœæŸ¥è¯¢](#37-å¼‚æ­¥ç»“æœæŸ¥è¯¢)
    - [3.8 å‡½æ•°è°ƒç”¨](#38-å‡½æ•°è°ƒç”¨)
      - [3.8.1 ç½‘é¡µæœç´¢ (web\_search)](#381-ç½‘é¡µæœç´¢-web_search)
      - [3.8.2 ç½‘é¡µé˜…è¯»å™¨ (page\_reader)](#382-ç½‘é¡µé˜…è¯»å™¨-page_reader)
  - [4. CLI å·¥å…·](#4-cli-å·¥å…·)
    - [4.1 å®‰è£… CLI](#41-å®‰è£…-cli)
    - [4.2 å‘½ä»¤åˆ—è¡¨](#42-å‘½ä»¤åˆ—è¡¨)
      - [ä¸»å‘½ä»¤](#ä¸»å‘½ä»¤)
      - [èŠå¤©å®Œæˆ (`chat`)](#èŠå¤©å®Œæˆ-chat)
      - [è§†è§‰èŠå¤© (`vision`)](#è§†è§‰èŠå¤©-vision)
      - [æ–‡æœ¬è½¬è¯­éŸ³ (`tts`)](#æ–‡æœ¬è½¬è¯­éŸ³-tts)
      - [è¯­éŸ³è½¬æ–‡æœ¬ (`asr`)](#è¯­éŸ³è½¬æ–‡æœ¬-asr)
      - [å›¾ç‰‡ç”Ÿæˆ (`image`)](#å›¾ç‰‡ç”Ÿæˆ-image)
      - [è§†é¢‘ç”Ÿæˆ (`video`)](#è§†é¢‘ç”Ÿæˆ-video)
      - [å¼‚æ­¥ç»“æœæŸ¥è¯¢ (`async-result`)](#å¼‚æ­¥ç»“æœæŸ¥è¯¢-async-result)
      - [å‡½æ•°è°ƒç”¨ (`function`)](#å‡½æ•°è°ƒç”¨-function)
    - [4.3 ä½¿ç”¨ç¤ºä¾‹](#43-ä½¿ç”¨ç¤ºä¾‹)
      - [åŸºæœ¬ç¤ºä¾‹](#åŸºæœ¬ç¤ºä¾‹)
      - [é«˜çº§ç¤ºä¾‹](#é«˜çº§ç¤ºä¾‹)
      - [æŸ¥çœ‹å¸®åŠ©](#æŸ¥çœ‹å¸®åŠ©)
  - [5. é”™è¯¯å¤„ç†](#5-é”™è¯¯å¤„ç†)
  - [6. TypeScript æ”¯æŒ](#6-typescript-æ”¯æŒ)
  - [7. æ³¨æ„äº‹é¡¹](#7-æ³¨æ„äº‹é¡¹)
  - [è®¸å¯è¯](#è®¸å¯è¯)
  - [æ›´æ–°æ—¥å¿—](#æ›´æ–°æ—¥å¿—)
    - [v0.0.11+](#v0011)

## 1. é…ç½®

åœ¨ä½¿ç”¨ SDK ä¹‹å‰ï¼Œæ‚¨å¿…é¡»åˆ›å»ºä¸€ä¸ªåä¸º `.z-ai-config` çš„é…ç½®æ–‡ä»¶ã€‚SDK ä¼šæŒ‰ä»¥ä¸‹é¡ºåºæœç´¢æ­¤æ–‡ä»¶ï¼š

1. å½“å‰é¡¹ç›®ç›®å½• (`./.z-ai-config`)
2. ç”¨æˆ·ä¸»ç›®å½• (`~/.z-ai-config`)
3. ç³»ç»Ÿç›®å½• (`/etc/.z-ai-config`)

é…ç½®æ–‡ä»¶å¿…é¡»æ˜¯æœ‰æ•ˆçš„ JSON æ ¼å¼ï¼Œå…·æœ‰ä»¥ä¸‹ç»“æ„ï¼š

```json
{
  "baseUrl": "YOUR_API_BASE_URL",
  "apiKey": "YOUR_API_KEY",
  "chatId": "OPTIONAL_CHAT_ID",
  "userId": "OPTIONAL_USER_ID"
}
```

**æ³¨æ„**: `baseUrl` åº”è¯¥åŒ…å« `/v1` å‰ç¼€ï¼ˆä¾‹å¦‚ï¼š`https://api.example.com/v1`ï¼‰

## 2. å®‰è£…

```bash
npm install z-ai-web-dev-sdk
```

## 3. JavaScript/TypeScript API

### 3.1 èŠå¤©å®Œæˆ

```javascript
import ZAI from 'z-ai-web-dev-sdk';

async function main() {
  try {
    const zai = await ZAI.create();

    const completion = await zai.chat.completions.create({
      messages: [
        {
          role: 'assistant',
          content: 'You are a helpful assistant.'
        },
        {
          role: 'user',
          content: 'Hello, who are you?'
        }
      ],
      thinking: { type: 'disabled' }, // å¯é€‰ï¼Œé»˜è®¤: disabledï¼Œå¯è®¾ç½®ä¸º enabled
      // å…¶ä»–å‚æ•°å¦‚ temperature, max_tokens ç­‰å¯ä»¥åœ¨è¿™é‡Œæ·»åŠ 
    });

    console.log('å®Œæ•´ API å“åº”:', completion);
    const messageContent = completion.choices[0]?.message?.content;
    if (messageContent) {
      console.log('åŠ©æ‰‹å›å¤:', messageContent);
    }
  } catch (error) {
    console.error('å‘ç”Ÿé”™è¯¯:', error.message);
  }
}

main();
```

### 3.2 è§†è§‰æ¨¡å‹èŠå¤©

```javascript
import ZAI from 'z-ai-web-dev-sdk';

async function visionChat() {
  try {
    const zai = await ZAI.create();

    const response = await zai.chat.completions.createVision({
      messages: [
        {
          role: 'user',
          content: [
            {
              type: 'text',
              text: 'æè¿°è¿™å¼ å›¾ç‰‡'
            },
            {
              type: 'image_url',
              image_url: {
                url: 'https://example.com/image.jpg' // url
              }
            },
            {
              type: 'video_url',
              video_url: {
                url: 'https://example.com/image.mp4' // mp4, mkv, mov
              }
            },
            {
              type: 'file_url',
              file_url: {
                url: 'https://example.com/image.pdf' // pdfã€txtã€wordã€jsonlã€xlsxã€pptx...
              }
            }
          ]
        }
      ],
      thinking: { type: 'disabled' } // å¯é€‰ï¼Œé»˜è®¤: disabledï¼Œå¯è®¾ç½®ä¸º enabled
    });

    console.log('è§†è§‰æ¨¡å‹å›å¤:', response.choices[0]?.message?.content);
  } catch (error) {
    console.error('è§†è§‰èŠå¤©å¤±è´¥:', error.message);
  }
}

visionChat();
```

### 3.3 æ–‡æœ¬è½¬è¯­éŸ³ (TTS)

```javascript
import ZAI from 'z-ai-web-dev-sdk';
import fs from 'fs';

async function textToSpeech() {
  try {
    const zai = await ZAI.create();

    const response = await zai.audio.tts.create({
      input: 'ä½ å¥½ï¼Œä¸–ç•Œï¼',
      voice: 'tongtong', // å¯é€‰ï¼Œé»˜è®¤: tongtong
      speed: 1.0, // å¯é€‰ï¼Œ0.5-2.0
      response_format: 'wav', // å¯é€‰: wav, pcmã€‚æµå¼ç”ŸæˆéŸ³é¢‘æ—¶ï¼Œä»…æ”¯æŒpcm
      stream: false // å¯é€‰: true ä¸ºæµå¼è¾“å‡º
    });

    // è¿”å› Response å¯¹è±¡ï¼Œå¯ä»¥è·å– headers å’Œ body
    const contentType = response.headers.get('content-type') || '';
    console.log('éŸ³é¢‘ç±»å‹:', contentType);
    
    // è·å–éŸ³é¢‘æ•°æ®
    const arrayBuffer = await response.arrayBuffer();
    const buffer = Buffer.from(new Uint8Array(arrayBuffer));
    fs.writeFileSync('./output.wav', buffer);
    console.log('éŸ³é¢‘å·²ä¿å­˜åˆ° output.wav');
  } catch (error) {
    console.error('TTS å¤±è´¥:', error.message);
  }
}

textToSpeech();
```

#### æµå¼ä¼ è¾“æ ¼å¼

å½“ `stream: true` æ—¶ï¼ŒTTS API è¿”å› Server-Sent Events (SSE) æ ¼å¼çš„æµå¼æ•°æ®ã€‚å“åº”æ˜¯ä¸€ä¸ª `ReadableStream`ï¼Œæ¯è¡Œä»¥ `data: ` å¼€å¤´ï¼ŒåŒ…å« JSON æ ¼å¼çš„æ•°æ®ã€‚

**æµå¼å“åº”æ ¼å¼ç¤ºä¾‹**ï¼š

```
data: {"id":"202512161623516be8a51d20774ea4","created":1765873431,"model":"glm-tts","choices":[{"index":0,"delta":{"role":"assistant","content":"AAAAU74AWAGKAt4DggVMB1IIYwlGCgcLPAs=","return_sample_rate":24000,"return_format":"pcm"}}]}

data: {"id":"202512161623516be8a51d20774ea4","created":1765873431,"model":"glm-tts","choices":[{"index":1,"delta":{"role":"assistant","content":"cAoECYAHAAAAAAAAAAAAAA","return_sample_rate":24000,"return_format":"pcm"}}]}

data: {"choices":[{"finish_reason":"stop","index":3}],"created":1765873432,"id":"202512161623516be8a51d20774ea4","model":"glm-tts"}
```

**æµå¼ä¼ è¾“ä½¿ç”¨ç¤ºä¾‹**ï¼š

```javascript
import ZAI from 'z-ai-web-dev-sdk';
import { Readable } from 'stream';

async function streamTTS() {
  try {
    const zai = await ZAI.create();

    const response = await zai.audio.tts.create({
      input: 'ä½ å¥½ï¼Œä¸–ç•Œï¼',
      voice: 'tongtong',
      response_format: 'pcm', // æµå¼ä¼ è¾“ä»…æ”¯æŒ pcm æ ¼å¼
      stream: true
    });

    // ä» Response å¯¹è±¡è·å– ReadableStream
    if (!response.body) {
      throw new Error('æµå¼å“åº”ä¸å¯ç”¨');
    }
    
    const reader = response.body.getReader();
    const decoder = new TextDecoder();
    let audioChunks = [];

    while (true) {
      const { done, value } = await reader.read();
      if (done) break;

      // å°† Uint8Array è½¬æ¢ä¸ºå­—ç¬¦ä¸²
      const chunk = decoder.decode(value, { stream: true });
      const lines = chunk.split('\n');

      for (const line of lines) {
        if (line.startsWith('data: ')) {
          const jsonStr = line.slice(6); // ç§»é™¤ "data: " å‰ç¼€
          if (jsonStr.trim() === '') continue;

          try {
            const data = JSON.parse(jsonStr);
            
            // æ£€æŸ¥æ˜¯å¦æ˜¯ç»“æŸæ ‡è®°
            if (data.choices && data.choices[0]?.finish_reason === 'stop') {
              console.log('æµå¼ä¼ è¾“å®Œæˆ');
              break;
            }

            // æå–éŸ³é¢‘æ•°æ®ï¼ˆbase64 ç¼–ç çš„ PCM æ•°æ®ï¼‰
            if (data.choices && data.choices[0]?.delta?.content) {
              const audioBase64 = data.choices[0].delta.content;
              const audioBuffer = Buffer.from(audioBase64, 'base64');
              audioChunks.push(audioBuffer);
              console.log(`æ”¶åˆ°éŸ³é¢‘å—ï¼Œå¤§å°: ${audioBuffer.length} å­—èŠ‚`);
            }
          } catch (e) {
            console.error('è§£æ JSON å¤±è´¥:', e, 'åŸå§‹æ•°æ®:', jsonStr);
          }
        }
      }
    }

    // åˆå¹¶æ‰€æœ‰éŸ³é¢‘å—
    if (audioChunks.length > 0) {
      const finalAudio = Buffer.concat(audioChunks);
      fs.writeFileSync('./output.pcm', finalAudio);
      console.log('æµå¼éŸ³é¢‘å·²ä¿å­˜åˆ° output.pcm');
    }
  } catch (error) {
    console.error('æµå¼ TTS å¤±è´¥:', error.message);
  }
}

streamTTS();
```

**å“åº”æ•°æ®ç»“æ„**ï¼š

- **ä¸­é—´æ•°æ®å—**ï¼šåŒ…å« `choices[].delta.content` å­—æ®µï¼Œå€¼ä¸º base64 ç¼–ç çš„ PCM éŸ³é¢‘æ•°æ®
- **ç»“æŸæ•°æ®å—**ï¼šåŒ…å« `choices[].finish_reason: "stop"` å­—æ®µï¼Œè¡¨ç¤ºæµå¼ä¼ è¾“ç»“æŸ
- æ¯ä¸ªæ•°æ®å—éƒ½åŒ…å« `id`ã€`created`ã€`model` ç­‰å…ƒæ•°æ®å­—æ®µ

**æ³¨æ„äº‹é¡¹**ï¼š
- æµå¼ä¼ è¾“æ—¶ï¼Œ`response_format` å¿…é¡»è®¾ç½®ä¸º `pcm`
- `content` å­—æ®µä¸­çš„éŸ³é¢‘æ•°æ®æ˜¯ base64 ç¼–ç çš„ PCM æ ¼å¼
- éœ€è¦æ‰‹åŠ¨è§£æ SSE æ ¼å¼å¹¶æå–éŸ³é¢‘æ•°æ®å—
- æ‰€æœ‰éŸ³é¢‘å—éœ€è¦åˆå¹¶åæ‰èƒ½å¾—åˆ°å®Œæ•´çš„éŸ³é¢‘æ–‡ä»¶

### 3.4 è¯­éŸ³è½¬æ–‡æœ¬ (ASR)

```javascript
import ZAI from 'z-ai-web-dev-sdk';
import fs from 'fs';

async function speechToText() {
  try {
    const zai = await ZAI.create();

    // è¯»å–éŸ³é¢‘æ–‡ä»¶å¹¶è½¬æ¢ä¸º base64
    const audioFile = fs.readFileSync('./audio.wav');
    const base64 = audioFile.toString('base64');

    const response = await zai.audio.asr.create({
      file_base64: base64 // æˆ–ä½¿ç”¨ file å‚æ•°
    });

    console.log('è¯†åˆ«ç»“æœ:', response.text);
  } catch (error) {
    console.error('ASR å¤±è´¥:', error.message);
  }
}

speechToText();
```

### 3.5 å›¾ç‰‡ç”Ÿæˆ

```javascript
import ZAI from 'z-ai-web-dev-sdk';

async function generateImage() {
  try {
    const zai = await ZAI.create();

    const response = await zai.images.generations.create({
      prompt: 'ä¸€åªå¯çˆ±çš„å°çŒ«å’ª', // å¿…éœ€
      size: '1024x1024' // å¯é€‰ï¼š1024x1024, 768x1344, 864x1152, 1344x768, 1152x864, 1440x720, 720x1440
    });

    // è·å– base64 æ ¼å¼çš„å›¾ç‰‡æ•°æ®
    const imageBase64 = response.data[0].base64;
    console.log('å›¾ç‰‡ base64 æ•°æ®:', imageBase64);

    // å¯ä»¥ç›´æ¥åœ¨ HTML ä¸­ä½¿ç”¨ï¼š
    // <img src="data:image/png;base64,${imageBase64}" alt="Generated Image" />
  } catch (error) {
    console.error('å›¾ç‰‡ç”Ÿæˆå¤±è´¥:', error.message);
  }
}

generateImage();
```

**æ”¯æŒçš„å°ºå¯¸**: `1024x1024`, `768x1344`, `864x1152`, `1344x768`, `1152x864`, `1440x720`, `720x1440`

### 3.6 è§†é¢‘ç”Ÿæˆ

è§†é¢‘ç”Ÿæˆæ˜¯å¼‚æ­¥ä»»åŠ¡ï¼Œéœ€è¦å…ˆåˆ›å»ºä»»åŠ¡ï¼Œç„¶åæŸ¥è¯¢ç»“æœã€‚

```javascript
import ZAI from 'z-ai-web-dev-sdk';

async function generateVideo() {
  try {
    const zai = await ZAI.create();

    // åˆ›å»ºè§†é¢‘ç”Ÿæˆä»»åŠ¡
    const task = await zai.video.generations.create({
      prompt: 'A cat is playing with a ball.',
      quality: 'speed', // æˆ– 'quality'
      with_audio: false,
      size: '1920x1080',
      fps: 30,
      duration: 5
    });

    console.log('Task ID:', task.id);
    console.log('Task Status:', task.task_status);

    // è½®è¯¢æŸ¥è¯¢ç»“æœ
    let result = await zai.async.result.query(task.id);
    let pollCount = 0;
    const maxPolls = 60;
    const pollInterval = 5000; // 5 seconds

    while (result.task_status === 'PROCESSING' && pollCount < maxPolls) {
      pollCount++;
      console.log(`Polling ${pollCount}/${maxPolls}: Status is ${result.task_status}`);
      await new Promise(resolve => setTimeout(resolve, pollInterval));
      result = await zai.async.result.query(task.id);
    }

    if (result.task_status === 'SUCCESS') {
      // è·å–è§†é¢‘URL
      const videoUrl = result.video_result?.[0]?.url || 
                       result.video_url || 
                       result.url || 
                       result.video;
      console.log('Video URL:', videoUrl);
    } else {
      console.log('Task failed or still processing');
    }
  } catch (error) {
    console.error('Video generation failed:', error.message);
  }
}

generateVideo();
```

**æ”¯æŒçš„å‚æ•°**:
- `prompt` (å¯é€‰): è§†é¢‘çš„æ–‡æœ¬æè¿°
- `image_url` (å¯é€‰): å›¾ç‰‡URLï¼Œå¯ä»¥æ˜¯å­—ç¬¦ä¸²ï¼ˆå•å¼ å›¾ç‰‡ï¼‰æˆ–å­—ç¬¦ä¸²æ•°ç»„ï¼ˆé¦–å°¾å¸§æ¨¡å¼ï¼Œ2å¼ å›¾ç‰‡ï¼‰
- `quality` (å¯é€‰): è¾“å‡ºæ¨¡å¼ `speed` æˆ– `quality`ï¼ˆé»˜è®¤: `speed`ï¼‰
- `with_audio` (å¯é€‰): æ˜¯å¦ç”ŸæˆAIéŸ³æ•ˆï¼ˆé»˜è®¤: `false`ï¼‰
- `size` (å¯é€‰): è§†é¢‘åˆ†è¾¨ç‡ï¼Œå¦‚ `"1920x1080"`
- `fps` (å¯é€‰): è§†é¢‘å¸§ç‡ `30` æˆ– `60`ï¼ˆé»˜è®¤: `30`ï¼‰
- `duration` (å¯é€‰): è§†é¢‘æ—¶é•¿ï¼ˆç§’ï¼‰`5` æˆ– `10`ï¼ˆé»˜è®¤: `5`ï¼‰
- `model` (å¯é€‰): æ¨¡å‹åç§°

**å“åº”æ ¼å¼**:
- åˆ›å»ºä»»åŠ¡è¿”å›: `{ id: string, task_status: 'PROCESSING' | 'SUCCESS' | 'FAIL', ... }`
- æŸ¥è¯¢ç»“æœè¿”å›: `{ task_status: 'PROCESSING' | 'SUCCESS' | 'FAIL', video_result: [{ url: string }], ... }`

### 3.7 å¼‚æ­¥ç»“æœæŸ¥è¯¢

æŸ¥è¯¢ä»»ä½•å¼‚æ­¥ä»»åŠ¡çš„ç»“æœï¼ˆå¦‚è§†é¢‘ç”Ÿæˆï¼‰ï¼š

```javascript
import ZAI from 'z-ai-web-dev-sdk';

async function queryAsyncResult() {
  try {
    const zai = await ZAI.create();

    const taskId = 'your-task-id';
    const result = await zai.async.result.query(taskId);

    console.log('Task Status:', result.task_status);
    
    if (result.task_status === 'SUCCESS') {
      // è§†é¢‘ç”Ÿæˆç»“æœ
      const videoUrl = result.video_result?.[0]?.url || 
                       result.video_url || 
                       result.url || 
                       result.video;
      if (videoUrl) {
        console.log('Video URL:', videoUrl);
      }
    } else if (result.task_status === 'PROCESSING') {
      console.log('Task is still processing');
    } else {
      console.log('Task failed');
    }
  } catch (error) {
    console.error('Query failed:', error.message);
  }
}

queryAsyncResult();
```

### 3.8 å‡½æ•°è°ƒç”¨

#### 3.8.1 ç½‘é¡µæœç´¢ (web_search)

```javascript
import ZAI from 'z-ai-web-dev-sdk';

async function invokeWebSearch() {
  try {
    const zai = await ZAI.create();

    // è°ƒç”¨ web_search å‡½æ•°
    const results = await zai.functions.invoke('web_search', {
      query: 'TypeScript æœ€æ–°ç‰¹æ€§',
      num: 5,
      recency_days: 10
    });

    console.log('æœç´¢ç»“æœ:', results);
  } catch (error) {
    console.error('å‡½æ•°è°ƒç”¨å¤±è´¥:', error.message);
  }
}

invokeWebSearch();
```

#### 3.8.2 ç½‘é¡µé˜…è¯»å™¨ (page_reader)

`page_reader` å‡½æ•°å¯ä»¥è¯»å–å¹¶è§£æç½‘é¡µå†…å®¹ï¼Œè¿”å›é¡µé¢çš„ HTMLã€æ ‡é¢˜ã€å‘å¸ƒæ—¶é—´ç­‰ä¿¡æ¯ã€‚

```javascript
import ZAI from 'z-ai-web-dev-sdk';

async function invokePageReader() {
  try {
    const zai = await ZAI.create();

    // è°ƒç”¨ page_reader å‡½æ•°
    const result = await zai.functions.invoke('page_reader', {
      url: 'https://example.com'
    });

    console.log('é¡µé¢æ ‡é¢˜:', result.data.title);
    console.log('é¡µé¢URL:', result.data.url);
    console.log('å‘å¸ƒæ—¶é—´:', result.data.publishedTime);
    console.log('HTMLå†…å®¹:', result.data.html);
    console.log('Tokenä½¿ç”¨é‡:', result.data.usage.tokens);
  } catch (error) {
    console.error('å‡½æ•°è°ƒç”¨å¤±è´¥:', error.message);
  }
}

invokePageReader();
```

**è¿”å›æ•°æ®ç»“æ„**:
- `code`: å“åº”ä»£ç 
- `data`: é¡µé¢æ•°æ®
  - `html`: é¡µé¢çš„ HTML å†…å®¹
  - `title`: é¡µé¢æ ‡é¢˜
  - `url`: é¡µé¢ URL
  - `publishedTime`: å‘å¸ƒæ—¶é—´ï¼ˆå¯é€‰ï¼‰
  - `usage.tokens`: Token ä½¿ç”¨é‡
- `meta`: å…ƒæ•°æ®
  - `usage.tokens`: Token ä½¿ç”¨é‡
- `status`: çŠ¶æ€ç 

## 4. CLI å·¥å…·

SDK æä¾›äº†åŠŸèƒ½å®Œæ•´çš„å‘½ä»¤è¡Œå·¥å…·ï¼Œæ”¯æŒæ‰€æœ‰ API åŠŸèƒ½ã€‚

### 4.1 å®‰è£… CLI

å…¨å±€å®‰è£… SDK ä»¥ä½¿ç”¨ CLI å‘½ä»¤ï¼š

```bash
npm install -g z-ai-web-dev-sdk
```

å®‰è£…åå¯ä»¥ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤ï¼š
- `z-ai` - ä¸»å‘½ä»¤ï¼ˆæ¨èï¼‰
- `z-ai-generate` - å›¾ç‰‡ç”Ÿæˆå‘½ä»¤ï¼ˆå‘åå…¼å®¹ï¼‰

### 4.2 å‘½ä»¤åˆ—è¡¨

#### ä¸»å‘½ä»¤

```bash
z-ai <å‘½ä»¤> [é€‰é¡¹]
```

å¯ç”¨å‘½ä»¤ï¼š
- `chat` - èŠå¤©å®Œæˆ
- `vision` - è§†è§‰æ¨¡å‹èŠå¤©
- `tts` - æ–‡æœ¬è½¬è¯­éŸ³
- `asr` - è¯­éŸ³è½¬æ–‡æœ¬
- `image` - å›¾ç‰‡ç”Ÿæˆ
- `video` - è§†é¢‘ç”Ÿæˆ
- `async-result` - æŸ¥è¯¢å¼‚æ­¥ç»“æœ
- `function` - å‡½æ•°è°ƒç”¨

#### èŠå¤©å®Œæˆ (`chat`)

```bash
z-ai chat --prompt "ä½ å¥½" --output response.json
z-ai chat -p "è§£é‡Šé‡å­è®¡ç®—" --system "ä½ æ˜¯ä¸€ä¸ªä¸“ä¸šçš„ç‰©ç†å­¦å®¶" --thinking
```

**å‚æ•°**:
- `--prompt, -p <æ–‡æœ¬>`: **å¿…éœ€** - ç”¨æˆ·æ¶ˆæ¯å†…å®¹
- `--system, -s <æ–‡æœ¬>`: å¯é€‰ - ç³»ç»Ÿæç¤ºè¯
- `--thinking, -t`: å¯é€‰ - å¯ç”¨æ€ç»´é“¾ï¼ˆé»˜è®¤: disabledï¼Œä¼ å…¥æ­¤å‚æ•°å³å¯ç”¨ï¼‰
- `--output, -o <è·¯å¾„>`: å¯é€‰ - è¾“å‡ºæ–‡ä»¶è·¯å¾„ï¼ˆJSONæ ¼å¼ï¼‰
- `--stream`: å¯é€‰ - æµå¼è¾“å‡º

#### è§†è§‰èŠå¤© (`vision`)

```bash
z-ai vision --prompt "æè¿°è¿™å¼ å›¾ç‰‡" --image "https://example.com/image.jpg"
z-ai vision -p "è¿™æ˜¯ä»€ä¹ˆï¼Ÿ" -i "./photo.jpg" -i "./photo2.jpg" --thinking -o response.json
```

**å‚æ•°**:
- `--prompt, -p <æ–‡æœ¬>`: **å¿…éœ€** - ç”¨æˆ·æ¶ˆæ¯å†…å®¹
- `--image, -i <URLæˆ–è·¯å¾„>`: å¯é€‰ - å›¾ç‰‡URLæˆ–æœ¬åœ°æ–‡ä»¶è·¯å¾„ï¼ˆå¯å¤šæ¬¡ä½¿ç”¨æ·»åŠ å¤šå¼ å›¾ç‰‡ï¼‰
- `--thinking, -t`: å¯é€‰ - å¯ç”¨æ€ç»´é“¾ï¼ˆé»˜è®¤: disabledï¼Œä¼ å…¥æ­¤å‚æ•°å³å¯ç”¨ï¼‰
- `--output, -o <è·¯å¾„>`: å¯é€‰ - è¾“å‡ºæ–‡ä»¶è·¯å¾„ï¼ˆJSONæ ¼å¼ï¼‰
- `--stream`: å¯é€‰ - æµå¼è¾“å‡º

#### æ–‡æœ¬è½¬è¯­éŸ³ (`tts`)

```bash
z-ai tts --input "ä½ å¥½ï¼Œä¸–ç•Œ" --output "./output.wav"
z-ai tts -i "Hello World" -o "./hello.mp3" --voice "tongtong" --speed 1.2
```

**å‚æ•°**:
- `--input, -i <æ–‡æœ¬>`: **å¿…éœ€** - è¦è½¬æ¢çš„æ–‡æœ¬
- `--output, -o <è·¯å¾„>`: **å¿…éœ€** - è¾“å‡ºéŸ³é¢‘æ–‡ä»¶è·¯å¾„
- `--voice, -v <å£°éŸ³>`: å¯é€‰ - å£°éŸ³ç±»å‹ï¼ˆé»˜è®¤: tongtongï¼‰
- `--speed, -s <æ•°å­—>`: å¯é€‰ - è¯­é€Ÿï¼ˆ0.5-2.0ï¼Œé»˜è®¤: 1.0ï¼‰
- `--format, -f <æ ¼å¼>`: å¯é€‰ - è¾“å‡ºæ ¼å¼ï¼ˆwav, mp3, pcmï¼Œé»˜è®¤: wavï¼‰
- `--stream`: å¯é€‰ - æµå¼è¾“å‡º

#### è¯­éŸ³è½¬æ–‡æœ¬ (`asr`)

```bash
z-ai asr --file "./audio.wav" --output transcript.json
z-ai asr -f "./recording.mp3" -o result.json
```

**å‚æ•°**:
- `--file, -f <è·¯å¾„>`: **å¿…éœ€**ï¼ˆä¸ --base64 äºŒé€‰ä¸€ï¼‰ - éŸ³é¢‘æ–‡ä»¶è·¯å¾„
- `--base64, -b <base64>`: **å¿…éœ€**ï¼ˆä¸ --file äºŒé€‰ä¸€ï¼‰ - éŸ³é¢‘æ–‡ä»¶çš„base64ç¼–ç 
- `--output, -o <è·¯å¾„>`: å¯é€‰ - è¾“å‡ºæ–‡ä»¶è·¯å¾„ï¼ˆJSONæ ¼å¼ï¼‰
- `--stream`: å¯é€‰ - æµå¼è¾“å‡º

#### å›¾ç‰‡ç”Ÿæˆ (`image`)

```bash
z-ai image --prompt "ä¸€åªå¯çˆ±çš„å°çŒ«" --output "./cat.png"
z-ai image -p "ç¾ä¸½çš„é£æ™¯" -o "./landscape.png" -s 1344x768
```

**å‚æ•°**:
- `--prompt, -p <æ–‡æœ¬>`: **å¿…éœ€** - å›¾ç‰‡æè¿°æ–‡æœ¬
- `--output, -o <è·¯å¾„>`: **å¿…éœ€** - è¾“å‡ºå›¾ç‰‡æ–‡ä»¶è·¯å¾„ï¼ˆpng æ ¼å¼ï¼‰
- `--size, -s <å°ºå¯¸>`: å¯é€‰ - å›¾ç‰‡å°ºå¯¸ï¼ˆé»˜è®¤: 1024x1024ï¼‰
  - æ”¯æŒçš„å°ºå¯¸: `1024x1024`, `768x1344`, `864x1152`, `1344x768`, `1152x864`, `1440x720`, `720x1440`

#### è§†é¢‘ç”Ÿæˆ (`video`)

```bash
z-ai video --prompt "A cat is playing with a ball" --poll
z-ai video -p "Beautiful landscape" -q quality --size "1920x1080" --fps 60 --poll
z-ai video --image-url "https://example.com/image.png" --prompt "Make the scene move" --poll
```

**å‚æ•°**:
- `--prompt, -p <æ–‡æœ¬>`: å¯é€‰ - è§†é¢‘çš„æ–‡æœ¬æè¿°
- `--image-url, -i <URL>`: å¯é€‰ - å›¾ç‰‡URLï¼ˆå•å¼ å›¾ç‰‡æˆ–é¦–å°¾å¸§æ•°ç»„ï¼Œç”¨é€—å·åˆ†éš”ï¼‰
- `--quality, -q <æ¨¡å¼>`: å¯é€‰ - è¾“å‡ºæ¨¡å¼ `speed` æˆ– `quality`ï¼ˆé»˜è®¤: `speed`ï¼‰
- `--with-audio`: å¯é€‰ - æ˜¯å¦ç”ŸæˆAIéŸ³æ•ˆï¼ˆé»˜è®¤: `false`ï¼‰
- `--size, -s <å°ºå¯¸>`: å¯é€‰ - è§†é¢‘åˆ†è¾¨ç‡ï¼Œå¦‚ `"1920x1080"`
- `--fps <å¸§ç‡>`: å¯é€‰ - è§†é¢‘å¸§ç‡ `30` æˆ– `60`ï¼ˆé»˜è®¤: `30`ï¼‰
- `--duration, -d <æ—¶é•¿>`: å¯é€‰ - è§†é¢‘æ—¶é•¿ï¼ˆç§’ï¼‰`5` æˆ– `10`ï¼ˆé»˜è®¤: `5`ï¼‰
- `--model, -m <æ¨¡å‹>`: å¯é€‰ - æ¨¡å‹åç§°
- `--poll`: å¯é€‰ - è‡ªåŠ¨è½®è¯¢ç›´åˆ°ä»»åŠ¡å®Œæˆ
- `--poll-interval <ç§’>`: å¯é€‰ - è½®è¯¢é—´éš”ï¼ˆç§’ï¼‰ï¼ˆé»˜è®¤: `5`ï¼‰
- `--max-polls <æ¬¡æ•°>`: å¯é€‰ - æœ€å¤§è½®è¯¢æ¬¡æ•°ï¼ˆé»˜è®¤: `60`ï¼‰
- `--output, -o <è·¯å¾„>`: å¯é€‰ - è¾“å‡ºç»“æœæ–‡ä»¶è·¯å¾„ï¼ˆJSONæ ¼å¼ï¼‰

**ç¤ºä¾‹**:
```bash
# åˆ›å»ºè§†é¢‘ç”Ÿæˆä»»åŠ¡ï¼ˆä¸è½®è¯¢ï¼‰
z-ai video --prompt "A cat playing" --size "1920x1080"

# åˆ›å»ºä»»åŠ¡å¹¶è‡ªåŠ¨è½®è¯¢ç›´åˆ°å®Œæˆ
z-ai video --prompt "Beautiful sunset" --poll

# ä½¿ç”¨å›¾ç‰‡ç”Ÿæˆè§†é¢‘
z-ai video --image-url "https://example.com/image.png" --prompt "Make it move" --poll

# é¦–å°¾å¸§æ¨¡å¼ï¼ˆä¸¤å¼ å›¾ç‰‡ï¼‰
z-ai video --image-url "https://example.com/frame1.png,https://example.com/frame2.png" --prompt "Smooth transition" --poll
```

#### å¼‚æ­¥ç»“æœæŸ¥è¯¢ (`async-result`)

```bash
z-ai async-result --id "16591731777601843-8059626559669415615"
z-ai async-result -i "task-id-123" --poll
z-ai async-result --id "task-id-123" --poll --poll-interval 10 --max-polls 30
```

**å‚æ•°**:
- `--id, -i <ä»»åŠ¡ID>`: **å¿…éœ€** - ä»»åŠ¡ID
- `--poll`: å¯é€‰ - è‡ªåŠ¨è½®è¯¢ç›´åˆ°ä»»åŠ¡å®Œæˆ
- `--poll-interval <ç§’>`: å¯é€‰ - è½®è¯¢é—´éš”ï¼ˆç§’ï¼‰ï¼ˆé»˜è®¤: `5`ï¼‰
- `--max-polls <æ¬¡æ•°>`: å¯é€‰ - æœ€å¤§è½®è¯¢æ¬¡æ•°ï¼ˆé»˜è®¤: `60`ï¼‰
- `--output, -o <è·¯å¾„>`: å¯é€‰ - è¾“å‡ºç»“æœæ–‡ä»¶è·¯å¾„ï¼ˆJSONæ ¼å¼ï¼‰

**ç¤ºä¾‹**:
```bash
# æŸ¥è¯¢ä¸€æ¬¡ç»“æœ
z-ai async-result --id "task-id-123"

# è‡ªåŠ¨è½®è¯¢ç›´åˆ°å®Œæˆ
z-ai async-result -i "task-id-123" --poll

# è‡ªå®šä¹‰è½®è¯¢å‚æ•°
z-ai async-result --id "task-id-123" --poll --poll-interval 10 --max-polls 30 -o result.json
```

#### å‡½æ•°è°ƒç”¨ (`function`)

**ç½‘é¡µæœç´¢ç¤ºä¾‹**:
```bash
z-ai function --name "web_search" --args '{"query": "AI", "num": 5}'
z-ai function -n web_search -a '{"query": "TypeScript", "num": 3}' -o result.json
```

**ç½‘é¡µé˜…è¯»å™¨ç¤ºä¾‹**:
```bash
z-ai function --name "page_reader" --args '{"url": "https://example.com"}'
z-ai function -n page_reader -a '{"url": "https://www.google.com"}' -o page.json
```

**å‚æ•°**:
- `--name, -n <å‡½æ•°å>`: **å¿…éœ€** - å‡½æ•°åç§°ï¼ˆå¦‚: `web_search`, `page_reader`ï¼‰
- `--args, -a <JSON>`: **å¿…éœ€** - å‡½æ•°å‚æ•°ï¼ˆJSONæ ¼å¼ï¼‰
  - `web_search`: `{"query": "æœç´¢å…³é”®è¯", "num": 5, "recency_days": 10}`
  - `page_reader`: `{"url": "https://example.com"}`
- `--output, -o <è·¯å¾„>`: å¯é€‰ - è¾“å‡ºæ–‡ä»¶è·¯å¾„ï¼ˆJSONæ ¼å¼ï¼‰

### 4.3 ä½¿ç”¨ç¤ºä¾‹

#### åŸºæœ¬ç¤ºä¾‹

```bash
# èŠå¤©å¯¹è¯
z-ai chat -p "ä»€ä¹ˆæ˜¯äººå·¥æ™ºèƒ½ï¼Ÿ" -o response.json

# è§†è§‰åˆ†æ
z-ai vision -p "è¿™å¼ å›¾ç‰‡é‡Œæœ‰ä»€ä¹ˆï¼Ÿ" -i "./photo.jpg"

# æ–‡æœ¬è½¬è¯­éŸ³
z-ai tts -i "æ¬¢è¿ä½¿ç”¨ Z AI SDK" -o welcome.wav

# è¯­éŸ³è¯†åˆ«
z-ai asr -f recording.wav -o transcript.json

# å›¾ç‰‡ç”Ÿæˆ
z-ai image -p "æœªæ¥åŸå¸‚" -o future_city.png

# å‡½æ•°è°ƒç”¨ - ç½‘é¡µæœç´¢
z-ai function -n web_search -a '{"query": "æœ€æ–°AIæŠ€æœ¯", "num": 5}'

# å‡½æ•°è°ƒç”¨ - ç½‘é¡µé˜…è¯»å™¨
z-ai function -n page_reader -a '{"url": "https://example.com"}' -o page.json

# è§†é¢‘ç”Ÿæˆï¼ˆè‡ªåŠ¨è½®è¯¢ï¼‰
z-ai video -p "A beautiful sunset" --poll

# æŸ¥è¯¢å¼‚æ­¥ç»“æœ
z-ai async-result -i "task-id-123" --poll
```

#### é«˜çº§ç¤ºä¾‹

```bash
# å¸¦ç³»ç»Ÿæç¤ºè¯çš„èŠå¤©
z-ai chat \
  --prompt "è§£é‡Šç›¸å¯¹è®º" \
  --system "ä½ æ˜¯ä¸€ä¸ªç‰©ç†å­¦å®¶ï¼Œç”¨ç®€å•æ˜“æ‡‚çš„æ–¹å¼è§£é‡Šå¤æ‚æ¦‚å¿µ" \
  --output physics_explanation.json

# å¤šå›¾ç‰‡è§†è§‰åˆ†æ
z-ai vision \
  -p "æ¯”è¾ƒè¿™ä¸¤å¼ å›¾ç‰‡çš„å·®å¼‚" \
  -i "./image1.jpg" \
  -i "./image2.jpg" \
  -o comparison.json

# é«˜è´¨é‡è¯­éŸ³ç”Ÿæˆ
z-ai tts \
  -i "è¿™æ˜¯ä¸€æ®µé«˜è´¨é‡çš„è¯­éŸ³åˆæˆæµ‹è¯•" \
  -o high_quality.wav \
  --voice "tongtong" \
  --speed 1.1 \
  --format wav

# ç”Ÿæˆå®½å±å›¾ç‰‡
z-ai image \
  -p "å£®è§‚çš„æ—¥å‡ºæ™¯è‰²ï¼Œ4Ké«˜æ¸…" \
  -o sunrise.png \
  -s 1440x720

# è§†é¢‘ç”Ÿæˆå¹¶è‡ªåŠ¨è½®è¯¢
z-ai video \
  -p "A cat playing with a ball" \
  --quality quality \
  --size "1920x1080" \
  --fps 60 \
  --poll \
  -o video_task.json

# ä½¿ç”¨å›¾ç‰‡ç”Ÿæˆè§†é¢‘
z-ai video \
  --image-url "https://example.com/image.png" \
  -p "Make the scene move" \
  --poll

# æŸ¥è¯¢å¼‚æ­¥ç»“æœï¼ˆè‡ªåŠ¨è½®è¯¢ï¼‰
z-ai async-result \
  -i "task-id-123" \
  --poll \
  --poll-interval 10 \
  --max-polls 30 \
  -o result.json
```

#### æŸ¥çœ‹å¸®åŠ©

```bash
# ä¸»å¸®åŠ©
z-ai --help

# å‘½ä»¤å¸®åŠ©
z-ai chat --help
z-ai vision --help
z-ai tts --help
z-ai asr --help
z-ai image --help
z-ai video --help
z-ai async-result --help
z-ai function --help
```

## 5. é”™è¯¯å¤„ç†

```javascript
try {
  const zai = await ZAI.create();
  // API è°ƒç”¨...
} catch (error) {
  if (error.message.includes('Configuration file not found')) {
    console.error('è¯·åˆ›å»º .z-ai-config é…ç½®æ–‡ä»¶');
  } else if (error.message.includes('API request failed')) {
    console.error('API è¯·æ±‚å¤±è´¥ï¼Œè¯·æ£€æŸ¥ç½‘ç»œè¿æ¥å’Œé…ç½®');
  } else {
    console.error('æœªçŸ¥é”™è¯¯:', error.message);
  }
}
```

## 6. TypeScript æ”¯æŒ

SDK å®Œå…¨æ”¯æŒ TypeScriptï¼Œæä¾›å®Œæ•´çš„ç±»å‹å®šä¹‰ï¼š

```typescript
import ZAI, {
  CreateChatCompletionBody,
  CreateChatCompletionVisionBody,
  CreateAudioTTSBody,
  CreateAudioASRBody,
  CreateImageGenerationBody,
  CreateVideoGenerationBody,
  VideoGenerationResponse,
  AsyncResultResponse,
  ImageGenerationResponse,
  VisionMessage,
  VisionMultimodalContentItem
} from 'z-ai-web-dev-sdk';

// èŠå¤©å®Œæˆ
const chatRequest: CreateChatCompletionBody = {
  messages: [
    { role: 'user', content: 'Hello' }
  ]
};

// è§†è§‰èŠå¤©
const visionRequest: CreateChatCompletionVisionBody = {
  messages: [
    {
      role: 'user',
      content: [
        { type: 'text', text: 'æè¿°å›¾ç‰‡' },
        { type: 'image_url', image_url: { url: 'https://example.com/img.jpg' } }
      ]
    }
  ]
};

// å›¾ç‰‡ç”Ÿæˆ
const imageRequest: CreateImageGenerationBody = {
  prompt: 'ç¾ä¸½çš„èŠ±æœµ',
  size: '1024x1024'
};

// è§†é¢‘ç”Ÿæˆ
const videoRequest: CreateVideoGenerationBody = {
  prompt: 'A cat playing with a ball',
  quality: 'speed',
  size: '1920x1080',
  fps: 30,
  duration: 5
};
```

## 7. æ³¨æ„äº‹é¡¹

- âœ… ç¡®ä¿é…ç½®æ–‡ä»¶ä¸­çš„ `baseUrl` å’Œ `apiKey` æ­£ç¡®
- âœ… `baseUrl` åº”è¯¥åŒ…å« `/v1` å‰ç¼€
- âœ… CLI å·¥å…·ä¼šè‡ªåŠ¨åˆ›å»ºè¾“å‡ºç›®å½•ï¼ˆå¦‚æœä¸å­˜åœ¨ï¼‰
- âœ… å›¾ç‰‡ç”Ÿæˆè¿”å› base64 æ ¼å¼ï¼Œå¯ç›´æ¥ç”¨äº HTML
- âœ… TTS å’Œ ASR æ”¯æŒå¤šç§éŸ³é¢‘æ ¼å¼
- âœ… è§†è§‰æ¨¡å‹æ”¯æŒå¤šå›¾ç‰‡è¾“å…¥
- âœ… å‡½æ•°è°ƒç”¨æä¾›ç±»å‹å®‰å…¨çš„æ¥å£ï¼ˆæ”¯æŒ `web_search` å’Œ `page_reader`ï¼‰
- âœ… è§†é¢‘ç”Ÿæˆæ˜¯å¼‚æ­¥ä»»åŠ¡ï¼Œéœ€è¦è½®è¯¢æŸ¥è¯¢ç»“æœ
- âœ… è§†é¢‘ç”Ÿæˆæ”¯æŒæ–‡æœ¬è½¬è§†é¢‘ã€å›¾ç‰‡è½¬è§†é¢‘ã€é¦–å°¾å¸§è½¬è§†é¢‘ç­‰å¤šç§æ¨¡å¼
- âœ… å»ºè®®åœ¨ç”Ÿäº§ç¯å¢ƒä¸­æ·»åŠ é€‚å½“çš„é”™è¯¯å¤„ç†å’Œé‡è¯•æœºåˆ¶
- âœ… æ‰€æœ‰ CLI å‘½ä»¤éƒ½æ”¯æŒ `--help` æŸ¥çœ‹è¯¦ç»†å¸®åŠ©

## è®¸å¯è¯

ISC

## æ›´æ–°æ—¥å¿—

### v0.0.11+
- âœ¨ æ–°å¢è§†è§‰æ¨¡å‹èŠå¤©æ”¯æŒ
- âœ¨ æ–°å¢æ–‡æœ¬è½¬è¯­éŸ³ (TTS) åŠŸèƒ½
- âœ¨ æ–°å¢è¯­éŸ³è½¬æ–‡æœ¬ (ASR) åŠŸèƒ½
- âœ¨ æ–°å¢å‡½æ•°è°ƒç”¨åŠŸèƒ½
- âœ¨ æ–°å¢è§†é¢‘ç”ŸæˆåŠŸèƒ½
- âœ¨ æ–°å¢å¼‚æ­¥ç»“æœæŸ¥è¯¢åŠŸèƒ½
- âœ¨ å®Œæ•´çš„ CLI å·¥å…·æ”¯æŒæ‰€æœ‰åŠŸèƒ½
- ğŸ”„ ä¿æŒå‘åå…¼å®¹æ€§
